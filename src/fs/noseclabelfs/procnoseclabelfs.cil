;; SPDX-FileCopyrightText: Â© 2021 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(block proc

       (filecon "/proc" dir fs_context)
       (filecon "/proc/.*" any ())

       (genfscon "proc" "/" fs_context)

       (macro dontaudit_setattr_fs_dirs ((type ARG1))
	      (dontaudit ARG1 fs (dir (setattr))))

       (blockinherit .fs.macro_template_lnk_files)
       (blockinherit .noseclabelfs.template)

       (call .xattr.associate_fs (fs)))

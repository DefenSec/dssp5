;; SPDX-FileCopyrightText: Â© 2021 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(block hugetlb

       (filecon "/dev/hugepages" dir ())
       (filecon "/dev/hugepages/.*" any ())

       (fsuse trans "hugetlbfs" fs_context)

       (blockinherit .fs.macro_template_dirs)
       (blockinherit .fs.macro_template_files)
       (blockinherit .seclabelfs.template)

       (allow fs self (filesystem (associate))))

;; SPDX-FileCopyrightText: Â© 2021 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(in sway

    (block idle

	   (blockinherit .dbus.client.template)
	   (blockinherit .user.agent.template)

	   (allow subj self create_unix_stream_socket)

	   (call .crypto.read_sysctlfile_pattern.type (subj))

	   (call .gcrypt.conf.read_file_pattern.type (subj))

	   (call .selinux.linked.type (subj))

	   (call .systemd.login.inhibit.type (subj))
	   (call .systemd.login.sendmsg_subj_dbus.type (subj))

	   (call .user.shell_exec_subj_type_transition (subj))

	   (call .wlroots.client.type (subj))

	   (block exec

		  (filecon "/usr/bin/swayidle" file file_context))))

(in systemd.login

    (call .sway.idle.sendmsg_subj_dbus.type (subj)))

(in user

    (call .sway.idle.role (role)))

(in wheel

    (call .sway.idle.role (role)))

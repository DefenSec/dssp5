;; SPDX-FileCopyrightText: Â© 2021 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(in dbus

    (call client.read_all_states (subj))

    (call .sys.read_subj_states (subj))

    (call .sys.user.read_subj_states (subj))

    (call .systemd.users.run.read_file_files (subj))
    (call .systemd.users.run.search_file_dirs (subj)))

(in dbus.common

    (call .kernel.search_sysfile_pattern.type (typeattr))

    (call .locale.data.read_file_pattern.type (typeattr))

    (call .security.search_fs_dirs (typeattr)))

(in dbus.conf

    (filecon "/etc/default/dbus" file file_context)
    (filecon "/etc/default/dbus\..*" file file_context))

(in dbus.conf.conf_file_type_transition_file

    (call .conf.file_type_transition
	  (ARG1 file file "dbus")))

(in dbus.exec

    (filecon "/usr/bin/dbus-daemon" file file_context))

;; system dbus-daemon specific method returns

(optional systemdlogin_systemduserrundir

	  (call systemd.userrundir.sendmsg_subj_dbus.type
		(systemd.login.subj)))

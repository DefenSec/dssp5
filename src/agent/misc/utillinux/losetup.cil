;; SPDX-FileCopyrightText: Â© 2021 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(block losetup

       (blockinherit .sys.agent.template)

       (call .block.search_sysfile_pattern.type (subj))

       (call .debug.search_fs_pattern.type (subj))

       (call .locale.data.map_file_pattern.type (subj))
       (call .locale.data.read_file_pattern.type (subj))

       (call .loop.readwrite_stordev_blk_files (subj))

       (call .loopcontrol.readwrite_nodedev_chr_files (subj))

       (call .mount.image.readwrite_all_files (subj))
       (call .mount.image.search_all_dirs (subj))

       (call .rbacsep.constrained.type (subj))
       (call .rbacsep.usefdsource.type (subj))

       (call .stordev.readwrite.type (subj))

       (block exec

	      (filecon "/usr/bin/losetup" file file_context)))

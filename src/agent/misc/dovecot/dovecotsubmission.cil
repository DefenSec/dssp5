;; SPDX-FileCopyrightText: Â© 2021 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(in dovecot

    (block submission

	   (blockinherit .agent.template)

	   (call dovecot.agent (subj exec.file))

	   (call .rbacsep.constrained.type (subj))
	   (call .rbacsep.usefdsource.type (subj))

	   (block exec

		  (filecon "/usr/lib/dovecot/submission" file file_context))

	   (block login

		  (blockinherit .agent.template)

		  (call dovecot.agent (subj exec.file))

		  (call .rbacsep.constrained.type (subj))
		  (call .rbacsep.usefdsource.type (subj))

		  (block exec

			 (filecon "/usr/lib/dovecot/submission-login" file
				  file_context)))))

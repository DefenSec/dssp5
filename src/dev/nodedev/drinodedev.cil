;; SPDX-FileCopyrightText: Â© 2021 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(block dri

       (filecon "/dev/dri/.+" char nodedev_context)

       (macro dontaudit_readwriteinherited_nodedev_chr_files ((type ARG1))
	      (dontaudit ARG1 nodedev readwriteinherited_chr_file))

       (macro getattr_nodedev_chr_files ((type ARG1))
	      (allow ARG1 nodedev (chr_file (getattr))))

       (macro map_nodedev_chr_files ((type ARG1))
	      (allow ARG1 nodedev (chr_file (map))))

       (macro setattr_nodedev_chr_files ((type ARG1))
	      (allow ARG1 nodedev (chr_file (setattr))))

       (blockinherit .nodedev.template)

       (call .rbacsep.exempt.obj.type (nodedev)))

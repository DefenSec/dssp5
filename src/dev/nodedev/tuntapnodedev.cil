;; SPDX-FileCopyrightText: Â© 2021 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(block tuntap

       (filecon "/dev/net/tun" char nodedev_context)
       (filecon "/dev/tap([0-9]+)?" char nodedev_context)

       (macro open_nodedev_chr_files ((type ARG1))
	      (allow ARG1 nodedev (chr_file (open))))

       (blockinherit .nodedev.template)

       (call .rbacsep.exempt.obj.type (nodedev)))

;; SPDX-FileCopyrightText: Â© 2021 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(block usb

       (filecon "/dev/bus/usb/.+" char nodedev_context)

       (macro getattr_nodedev_chr_files ((type ARG1))
	      (allow ARG1 nodedev (chr_file (getattr))))

       (macro setattr_nodedev_chr_files ((type ARG1))
	      (allow ARG1 nodedev (chr_file (setattr))))

       (blockinherit .nodedev.template)

       (call .rbacsep.exempt.obj.type (nodedev)))
